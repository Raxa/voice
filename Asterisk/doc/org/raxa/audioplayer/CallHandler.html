<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_21) on Wed Sep 11 20:02:41 IST 2013 -->
<title>CallHandler</title>
<meta name="date" content="2013-09-11">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="CallHandler";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/CallHandler.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li><a href="../../../org/raxa/audioplayer/CallSuccess.html" title="class in org.raxa.audioplayer"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?org/raxa/audioplayer/CallHandler.html" target="_top">Frames</a></li>
<li><a href="CallHandler.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.raxa.audioplayer</div>
<h2 title="Class CallHandler" class="title">Class CallHandler</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.asteriskjava.fastagi.AgiOperations</li>
<li>
<ul class="inheritance">
<li>org.asteriskjava.fastagi.BaseAgiScript</li>
<li>
<ul class="inheritance">
<li>org.raxa.audioplayer.CallHandler</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd>org.asteriskjava.fastagi.AgiChannel, org.asteriskjava.fastagi.AgiScript, <a href="../../../org/raxa/alertmessage/MessageInterface.html" title="interface in org.raxa.alertmessage">MessageInterface</a>, <a href="../../../org/raxa/database/VariableSetter.html" title="interface in org.raxa.database">VariableSetter</a></dd>
</dl>
<hr>
<br>
<pre>public class <span class="strong">CallHandler</span>
extends org.asteriskjava.fastagi.BaseAgiScript
implements <a href="../../../org/raxa/alertmessage/MessageInterface.html" title="interface in org.raxa.alertmessage">MessageInterface</a>, <a href="../../../org/raxa/database/VariableSetter.html" title="interface in org.raxa.database">VariableSetter</a></pre>
<div class="block">Outgoing Call Context here sets the following channel variable
 totalItem;item0,item1....,count
 
 CAUTION:Even if the patient has hung up the program is going to execute until it meets an exception or termination.</div>
<dl><dt><span class="strong">Author:</span></dt>
  <dd>atul</dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private org.asteriskjava.fastagi.AgiChannel</code></td>
<td class="colLast"><code><strong><a href="../../../org/raxa/audioplayer/CallHandler.html#channel">channel</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../org/raxa/audioplayer/CallHandler.html#language">language</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private org.apache.log4j.Logger</code></td>
<td class="colLast"><code><strong><a href="../../../org/raxa/audioplayer/CallHandler.html#logger">logger</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../org/raxa/audioplayer/CallHandler.html#pnumber">pnumber</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private org.asteriskjava.fastagi.AgiRequest</code></td>
<td class="colLast"><code><strong><a href="../../../org/raxa/audioplayer/CallHandler.html#request">request</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../org/raxa/audioplayer/CallHandler.html#speed">speed</a></strong></code>&nbsp;</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="fields_inherited_from_class_org.raxa.alertmessage.MessageInterface">
<!--   -->
</a>
<h3>Fields inherited from interface&nbsp;org.raxa.alertmessage.<a href="../../../org/raxa/alertmessage/MessageInterface.html" title="interface in org.raxa.alertmessage">MessageInterface</a></h3>
<code><a href="../../../org/raxa/alertmessage/MessageInterface.html#AUDIO_MODE">AUDIO_MODE</a>, <a href="../../../org/raxa/alertmessage/MessageInterface.html#TTS_MODE">TTS_MODE</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="fields_inherited_from_class_org.raxa.database.VariableSetter">
<!--   -->
</a>
<h3>Fields inherited from interface&nbsp;org.raxa.database.<a href="../../../org/raxa/database/VariableSetter.html" title="interface in org.raxa.database">VariableSetter</a></h3>
<code><a href="../../../org/raxa/database/VariableSetter.html#IVR_TYPE">IVR_TYPE</a>, <a href="../../../org/raxa/database/VariableSetter.html#SMS_TYPE">SMS_TYPE</a></code></li>
</ul>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../org/raxa/audioplayer/CallHandler.html#CallHandler()">CallHandler</a></strong>()</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../org/raxa/audioplayer/CallHandler.html#analysePatientOption(java.lang.String, char)">analysePatientOption</a></strong>(java.lang.String&nbsp;propertyFile,
                    char&nbsp;option)</code>
<div class="block">search for keyword from a property file with option as property field</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../org/raxa/audioplayer/CallHandler.html#doWhatPatientWant(java.lang.String, java.util.List, java.lang.String)">doWhatPatientWant</a></strong>(java.lang.String&nbsp;keyWord,
                 java.util.List&lt;<a href="../../../org/raxa/database/Patient.html" title="class in org.raxa.database">Patient</a>&gt;&nbsp;patientList,
                 java.lang.String&nbsp;language)</code>
<div class="block">Takes the Keyword and all the possible patientList associated with the phone number and patient prefer langauge
 Checks if the keyword require pid?
 If yes,ask for the patietn identity among patientList.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) java.util.List&lt;<a href="../../../org/raxa/database/Patient.html" title="class in org.raxa.database">Patient</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../org/raxa/audioplayer/CallHandler.html#getAllPatientWithNumber(java.lang.String)">getAllPatientWithNumber</a></strong>(java.lang.String&nbsp;pnumber)</code>
<div class="block">Return list of patient associated with a number</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.util.List</code></td>
<td class="colLast"><code><strong><a href="../../../org/raxa/audioplayer/CallHandler.html#getMessageContent(int)">getMessageContent</a></strong>(int&nbsp;msgId)</code>
<div class="block">used in Outgoing-Call Context.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private char</code></td>
<td class="colLast"><code><strong><a href="../../../org/raxa/audioplayer/CallHandler.html#getOptionUsingTTS(java.lang.String, java.lang.String, java.lang.String, int)">getOptionUsingTTS</a></strong>(java.lang.String&nbsp;toSpeak,
                 java.lang.String&nbsp;escapeDigits,
                 java.lang.String&nbsp;beepSeconds,
                 int&nbsp;numberOfTry)</code>
<div class="block">Play the text in desired langauge and stops if get an option.If not play a beep and wait for 3 seconds.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../org/raxa/audioplayer/CallHandler.html#getPatientIdfromList(java.util.List)">getPatientIdfromList</a></strong>(java.util.List&lt;<a href="../../../org/raxa/database/Patient.html" title="class in org.raxa.database">Patient</a>&gt;&nbsp;patientList)</code>
<div class="block">This speaks out name of all the patient name one by one and return the uuid for the name the caller chose
 
 What I don't like about it:after calling every name it will produce a beep and ask for option.If not get an answer say the other patient name and
 again beep,wait ask for an option
 
 can be changed to any other file.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private char</code></td>
<td class="colLast"><code><strong><a href="../../../org/raxa/audioplayer/CallHandler.html#getPatientOption(java.lang.String, java.lang.String, java.lang.String, int)">getPatientOption</a></strong>(java.lang.String&nbsp;fileLocation,
                java.lang.String&nbsp;timeout,
                java.lang.String&nbsp;escapeDigits,
                int&nbsp;numberOfRepeat)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../org/raxa/audioplayer/CallHandler.html#getPid(java.util.List)">getPid</a></strong>(java.util.List&lt;<a href="../../../org/raxa/database/Patient.html" title="class in org.raxa.database">Patient</a>&gt;&nbsp;patientList)</code>
<div class="block">Given a list of possible patient it returns the pid.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../org/raxa/audioplayer/CallHandler.html#getTTSNotation(java.lang.String)">getTTSNotation</a></strong>(java.lang.String&nbsp;preferLanguage)</code>
<div class="block">Use in Incoming-Call Context
 
Copied from org.raxa.module.ami.Outgoing.getTTSNotation Method.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../org/raxa/audioplayer/CallHandler.html#getValueFromPropertyFile(java.lang.String, java.lang.String)">getValueFromPropertyFile</a></strong>(java.lang.String&nbsp;property,
                        java.lang.String&nbsp;propertyFile)</code>
<div class="block">Gets value from properties file.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../org/raxa/audioplayer/CallHandler.html#handleIncomingCall()">handleIncomingCall</a></strong>()</code>
<div class="block">Use in Incoming-Call Context
 
 Handles patient incoming call.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../org/raxa/audioplayer/CallHandler.html#ifOptionNotChosenAfterManyTries()">ifOptionNotChosenAfterManyTries</a></strong>()</code>
<div class="block">Action to be taken when user doesnot choose any option</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../org/raxa/audioplayer/CallHandler.html#medicineReminder(java.lang.String)">medicineReminder</a></strong>(java.lang.String&nbsp;pid)</code>
<div class="block">Plays medicine Reminder to the patient</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../org/raxa/audioplayer/CallHandler.html#playFile(java.lang.String)">playFile</a></strong>(java.lang.String&nbsp;fileLocation)</code>
<div class="block">Play any voice file in Location fileLocation
 
 Caution:Don't give any extension.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../org/raxa/audioplayer/CallHandler.html#playMainMenu(java.lang.String, java.util.List)">playMainMenu</a></strong>(java.lang.String&nbsp;pnumber,
            java.util.List&lt;<a href="../../../org/raxa/database/Patient.html" title="class in org.raxa.database">Patient</a>&gt;&nbsp;patientList)</code>
<div class="block">Plays the main menu using TTS.The main menu String is fetched from mainmenutext property file in english.properties.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../org/raxa/audioplayer/CallHandler.html#playUsingTTS(java.lang.String, java.lang.String)">playUsingTTS</a></strong>(java.lang.String&nbsp;message,
            java.lang.String&nbsp;ttsNotation)</code>
<div class="block">Use in Incoming-Call Context.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../org/raxa/audioplayer/CallHandler.html#playUsingTTS(java.lang.String, java.lang.String, java.lang.String)">playUsingTTS</a></strong>(java.lang.String&nbsp;message,
            java.lang.String&nbsp;ttsNotation,
            java.lang.String&nbsp;escapeDigits)</code>
<div class="block">Play the message using TTS and stop laying it as soon as it encounters any escape digits</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../org/raxa/audioplayer/CallHandler.html#provideMedicalInfo()">provideMedicalInfo</a></strong>()</code>
<div class="block">used in Outgoing-Call Context.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../org/raxa/audioplayer/CallHandler.html#sayWelcomeAndgetLanguage(java.util.List, java.lang.String)">sayWelcomeAndgetLanguage</a></strong>(java.util.List&lt;<a href="../../../org/raxa/database/Patient.html" title="class in org.raxa.database">Patient</a>&gt;&nbsp;patientList,
                        java.lang.String&nbsp;defaultLanguage)</code>
<div class="block">Choose a random prefer Language to be played to the patient if patient is registered.If not registered plays welcome with the default language.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../org/raxa/audioplayer/CallHandler.html#service(org.asteriskjava.fastagi.AgiRequest, org.asteriskjava.fastagi.AgiChannel)">service</a></strong>(org.asteriskjava.fastagi.AgiRequest&nbsp;request,
       org.asteriskjava.fastagi.AgiChannel&nbsp;channel)</code>
<div class="block">checks whether the call is incoming or outgoing.Handles the call accordingly</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../org/raxa/audioplayer/CallHandler.html#updateCount(int)">updateCount</a></strong>(int&nbsp;count)</code>
<div class="block">used in Outgoing-Call Context.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_org.asteriskjava.fastagi.AgiOperations">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;org.asteriskjava.fastagi.AgiOperations</h3>
<code>answer, continueAt, controlStreamFile, controlStreamFile, controlStreamFile, controlStreamFile, databaseDel, databaseDelTree, databaseDelTree, databaseGet, databasePut, exec, exec, getChannel, getChannelStatus, getData, getData, getData, getFullVariable, getFullVariable, getLastReply, getName, getOption, getOption, getUniqueId, getVariable, gosub, gosub, hangup, playMusicOnHold, playMusicOnHold, recordFile, recordFile, sayAlpha, sayAlpha, sayDateTime, sayDateTime, sayDateTime, sayDateTime, sayDigits, sayDigits, sayNumber, sayNumber, sayPhonetic, sayPhonetic, sayTime, sayTime, sendCommand, setAutoHangup, setCallerId, setContext, setExtension, setPriority, setVariable, speechActivateGrammar, speechCreate, speechCreate, speechDeactivateGrammar, speechDestroy, speechLoadGrammar, speechRecognize, speechRecognize, speechSet, speechUnloadGrammar, stopMusicOnHold, streamFile, streamFile, streamFile, verbose, waitForDigit</code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="request">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>request</h4>
<pre>private&nbsp;org.asteriskjava.fastagi.AgiRequest request</pre>
</li>
</ul>
<a name="channel">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>channel</h4>
<pre>private&nbsp;org.asteriskjava.fastagi.AgiChannel channel</pre>
</li>
</ul>
<a name="logger">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>logger</h4>
<pre>private&nbsp;org.apache.log4j.Logger logger</pre>
</li>
</ul>
<a name="language">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>language</h4>
<pre>java.lang.String language</pre>
</li>
</ul>
<a name="pnumber">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>pnumber</h4>
<pre>java.lang.String pnumber</pre>
</li>
</ul>
<a name="speed">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>speed</h4>
<pre>final&nbsp;java.lang.String speed</pre>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../constant-values.html#org.raxa.audioplayer.CallHandler.speed">Constant Field Values</a></dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="CallHandler()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>CallHandler</h4>
<pre>public&nbsp;CallHandler()</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="service(org.asteriskjava.fastagi.AgiRequest, org.asteriskjava.fastagi.AgiChannel)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>service</h4>
<pre>public&nbsp;void&nbsp;service(org.asteriskjava.fastagi.AgiRequest&nbsp;request,
           org.asteriskjava.fastagi.AgiChannel&nbsp;channel)
             throws org.asteriskjava.fastagi.AgiException</pre>
<div class="block">checks whether the call is incoming or outgoing.Handles the call accordingly</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code>service</code>&nbsp;in interface&nbsp;<code>org.asteriskjava.fastagi.AgiScript</code></dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>org.asteriskjava.fastagi.AgiException</code></dd></dl>
</li>
</ul>
<a name="handleIncomingCall()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>handleIncomingCall</h4>
<pre>private&nbsp;void&nbsp;handleIncomingCall()
                         throws org.asteriskjava.fastagi.AgiException,
                                java.lang.Exception</pre>
<div class="block">Use in Incoming-Call Context
 
 Handles patient incoming call.
 
 Set patient number as pnumber
 
 INCOMPLETE</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>org.asteriskjava.fastagi.AgiException</code></dd>
<dd><code>java.lang.Exception</code></dd></dl>
</li>
</ul>
<a name="sayWelcomeAndgetLanguage(java.util.List, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sayWelcomeAndgetLanguage</h4>
<pre>private&nbsp;java.lang.String&nbsp;sayWelcomeAndgetLanguage(java.util.List&lt;<a href="../../../org/raxa/database/Patient.html" title="class in org.raxa.database">Patient</a>&gt;&nbsp;patientList,
                                        java.lang.String&nbsp;defaultLanguage)
                                           throws org.asteriskjava.fastagi.AgiException,
                                                  java.lang.Exception</pre>
<div class="block">Choose a random prefer Language to be played to the patient if patient is registered.If not registered plays welcome with the default language.
 
 Ask patient if he is comfortable with current language(1 for yes 2 for no).If not,provide him with a set of language(to be recorded manually)which TTS support.
 Enough care should be taken to map patient option with the language in langaugeMap.properties.(languageMap and voice File must go hand in hand.)</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>patientList</code> - </dd><dd><code>defaultLanguage</code> - </dd>
<dt><span class="strong">Returns:</span></dt><dd></dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>org.asteriskjava.fastagi.AgiException</code></dd>
<dd><code>java.lang.Exception</code></dd></dl>
</li>
</ul>
<a name="playMainMenu(java.lang.String, java.util.List)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>playMainMenu</h4>
<pre>private&nbsp;void&nbsp;playMainMenu(java.lang.String&nbsp;pnumber,
                java.util.List&lt;<a href="../../../org/raxa/database/Patient.html" title="class in org.raxa.database">Patient</a>&gt;&nbsp;patientList)
                   throws java.lang.Exception</pre>
<div class="block">Plays the main menu using TTS.The main menu String is fetched from mainmenutext property file in english.properties.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>pnumber</code> - </dd><dd><code>patientList</code> - </dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.Exception</code></dd></dl>
</li>
</ul>
<a name="doWhatPatientWant(java.lang.String, java.util.List, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>doWhatPatientWant</h4>
<pre>private&nbsp;void&nbsp;doWhatPatientWant(java.lang.String&nbsp;keyWord,
                     java.util.List&lt;<a href="../../../org/raxa/database/Patient.html" title="class in org.raxa.database">Patient</a>&gt;&nbsp;patientList,
                     java.lang.String&nbsp;language)
                        throws org.asteriskjava.fastagi.AgiException,
                               java.lang.Exception</pre>
<div class="block">Takes the Keyword and all the possible patientList associated with the phone number and patient prefer langauge
 Checks if the keyword require pid?
 If yes,ask for the patietn identity among patientList.
 Stores the pid and fetch asked information using the pid</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>keyWord</code> - </dd><dd><code>patientList</code> - </dd><dd><code>language</code> - </dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>org.asteriskjava.fastagi.AgiException</code></dd>
<dd><code>java.lang.Exception</code></dd></dl>
</li>
</ul>
<a name="getPid(java.util.List)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getPid</h4>
<pre>private&nbsp;java.lang.String&nbsp;getPid(java.util.List&lt;<a href="../../../org/raxa/database/Patient.html" title="class in org.raxa.database">Patient</a>&gt;&nbsp;patientList)
                         throws org.asteriskjava.fastagi.AgiException</pre>
<div class="block">Given a list of possible patient it returns the pid.
 then it stores the pid as the channel variable to avoid calculation again and agai
 
 Disadvantage:once patient pid is set it cannot query for anyone else while in the call.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>patientList</code> - </dd>
<dt><span class="strong">Returns:</span></dt><dd></dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>org.asteriskjava.fastagi.AgiException</code></dd></dl>
</li>
</ul>
<a name="medicineReminder(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>medicineReminder</h4>
<pre>private&nbsp;void&nbsp;medicineReminder(java.lang.String&nbsp;pid)
                       throws org.asteriskjava.fastagi.AgiException</pre>
<div class="block">Plays medicine Reminder to the patient</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>pid</code> - </dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>org.asteriskjava.fastagi.AgiException</code></dd></dl>
</li>
</ul>
<a name="getValueFromPropertyFile(java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getValueFromPropertyFile</h4>
<pre>private&nbsp;java.lang.String&nbsp;getValueFromPropertyFile(java.lang.String&nbsp;property,
                                        java.lang.String&nbsp;propertyFile)</pre>
<div class="block">Gets value from properties file.</div>
</li>
</ul>
<a name="playFile(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>playFile</h4>
<pre>private&nbsp;void&nbsp;playFile(java.lang.String&nbsp;fileLocation)
               throws org.asteriskjava.fastagi.AgiException</pre>
<div class="block">Play any voice file in Location fileLocation
 
 Caution:Don't give any extension. eg:/home/you/music/metallica/St.Anger</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>fileLocation</code> - </dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>org.asteriskjava.fastagi.AgiException</code></dd></dl>
</li>
</ul>
<a name="getPatientIdfromList(java.util.List)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getPatientIdfromList</h4>
<pre>private&nbsp;java.lang.String&nbsp;getPatientIdfromList(java.util.List&lt;<a href="../../../org/raxa/database/Patient.html" title="class in org.raxa.database">Patient</a>&gt;&nbsp;patientList)
                                       throws org.asteriskjava.fastagi.AgiException</pre>
<div class="block">This speaks out name of all the patient name one by one and return the uuid for the name the caller chose
 
 What I don't like about it:after calling every name it will produce a beep and ask for option.If not get an answer say the other patient name and
 again beep,wait ask for an option
 
 can be changed to any other file.
 
  Use in Incoming-Call Context</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>org.asteriskjava.fastagi.AgiException</code></dd></dl>
</li>
</ul>
<a name="getOptionUsingTTS(java.lang.String, java.lang.String, java.lang.String, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getOptionUsingTTS</h4>
<pre>private&nbsp;char&nbsp;getOptionUsingTTS(java.lang.String&nbsp;toSpeak,
                     java.lang.String&nbsp;escapeDigits,
                     java.lang.String&nbsp;beepSeconds,
                     int&nbsp;numberOfTry)
                        throws org.asteriskjava.fastagi.AgiException</pre>
<div class="block">Play the text in desired langauge and stops if get an option.If not play a beep and wait for 3 seconds.
 escape String</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>toSpeak</code> - </dd><dd><code>escapeDigits</code> - is a set of digits,if pressed,will stop the voice playing and send the pressed digits to option variable</dd><dd><code>beepSeconds:</code> - is time in milliseconds.After playing a beep the application will wait for beepSeconds for user to send an input</dd><dd><code>numberOfTry</code> - if failed to get an option it will play the same thing for numberOfTry times</dd>
<dt><span class="strong">Returns:</span></dt><dd></dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>org.asteriskjava.fastagi.AgiException</code></dd></dl>
</li>
</ul>
<a name="getPatientOption(java.lang.String, java.lang.String, java.lang.String, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getPatientOption</h4>
<pre>private&nbsp;char&nbsp;getPatientOption(java.lang.String&nbsp;fileLocation,
                    java.lang.String&nbsp;timeout,
                    java.lang.String&nbsp;escapeDigits,
                    int&nbsp;numberOfRepeat)
                       throws org.asteriskjava.fastagi.AgiException</pre>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>fileLocation</code> - location where pre-recorded voice is stored</dd><dd><code>timeout</code> - time(millisecond) to wait for patient to enter an option</dd><dd><code>escapeDigits</code> - when pressed stops the voice file playing and take the input as user choice</dd><dd><code>numberOfRepeat</code> - number of times to repeat the voice file if user fails to press an option</dd>
<dt><span class="strong">Returns:</span></dt><dd></dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>org.asteriskjava.fastagi.AgiException</code></dd></dl>
</li>
</ul>
<a name="ifOptionNotChosenAfterManyTries()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ifOptionNotChosenAfterManyTries</h4>
<pre>private&nbsp;void&nbsp;ifOptionNotChosenAfterManyTries()
                                      throws org.asteriskjava.fastagi.AgiException</pre>
<div class="block">Action to be taken when user doesnot choose any option</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>org.asteriskjava.fastagi.AgiException</code></dd></dl>
</li>
</ul>
<a name="analysePatientOption(java.lang.String, char)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>analysePatientOption</h4>
<pre>private&nbsp;java.lang.String&nbsp;analysePatientOption(java.lang.String&nbsp;propertyFile,
                                    char&nbsp;option)</pre>
<div class="block">search for keyword from a property file with option as property field</div>
</li>
</ul>
<a name="getAllPatientWithNumber(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getAllPatientWithNumber</h4>
<pre>java.util.List&lt;<a href="../../../org/raxa/database/Patient.html" title="class in org.raxa.database">Patient</a>&gt;&nbsp;getAllPatientWithNumber(java.lang.String&nbsp;pnumber)</pre>
<div class="block">Return list of patient associated with a number</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>pnumber</code> - </dd>
<dt><span class="strong">Returns:</span></dt><dd></dd></dl>
</li>
</ul>
<a name="playUsingTTS(java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>playUsingTTS</h4>
<pre>private&nbsp;void&nbsp;playUsingTTS(java.lang.String&nbsp;message,
                java.lang.String&nbsp;ttsNotation)
                   throws org.asteriskjava.fastagi.AgiException</pre>
<div class="block">Use in Incoming-Call Context.
 
 takes message and ttsNotation i.e (en,hi) and plays it</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - </dd><dd><code>ttsNotation</code> - </dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>org.asteriskjava.fastagi.AgiException</code></dd></dl>
</li>
</ul>
<a name="playUsingTTS(java.lang.String, java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>playUsingTTS</h4>
<pre>private&nbsp;void&nbsp;playUsingTTS(java.lang.String&nbsp;message,
                java.lang.String&nbsp;ttsNotation,
                java.lang.String&nbsp;escapeDigits)
                   throws org.asteriskjava.fastagi.AgiException</pre>
<div class="block">Play the message using TTS and stop laying it as soon as it encounters any escape digits</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - </dd><dd><code>ttsNotation</code> - </dd><dd><code>escapeDigits</code> - </dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>org.asteriskjava.fastagi.AgiException</code></dd></dl>
</li>
</ul>
<a name="getTTSNotation(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTTSNotation</h4>
<pre>public&nbsp;java.lang.String&nbsp;getTTSNotation(java.lang.String&nbsp;preferLanguage)</pre>
<div class="block">Use in Incoming-Call Context
 
Copied from org.raxa.module.ami.Outgoing.getTTSNotation Method. Just to make the AGI completely independent. 
Return ttsNotation for preferLanguage else return default Notation</div>
</li>
</ul>
<a name="provideMedicalInfo()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>provideMedicalInfo</h4>
<pre>private&nbsp;void&nbsp;provideMedicalInfo()
                         throws org.asteriskjava.fastagi.AgiException</pre>
<div class="block">used in Outgoing-Call Context.
 
 It loops between AGI and asterisk dial plan outgoing-call context.
 asterisk dial plan contains google TTS.
 If asked to play using TTS it returns and play it via google TTS.
 If asked to play using audio folder it loops back using while.
 
 It does use recursion.
 
 Warning:Unless you are familiar with asterisk dial plan don't mess with it.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>org.asteriskjava.fastagi.AgiException</code></dd></dl>
</li>
</ul>
<a name="updateCount(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>updateCount</h4>
<pre>private&nbsp;void&nbsp;updateCount(int&nbsp;count)
                  throws org.asteriskjava.fastagi.AgiException</pre>
<div class="block">used in Outgoing-Call Context.
 
 update how many ivrMsg:itemNumber of msgId has been played.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>count</code> - </dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>org.asteriskjava.fastagi.AgiException</code></dd></dl>
</li>
</ul>
<a name="getMessageContent(int)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getMessageContent</h4>
<pre>private&nbsp;java.util.List&nbsp;getMessageContent(int&nbsp;msgId)
                                  throws java.lang.Exception</pre>
<div class="block">used in Outgoing-Call Context.
 
 Get Message Content form IvrMsg</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>msgId</code> - </dd>
<dt><span class="strong">Returns:</span></dt><dd></dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.Exception</code></dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/CallHandler.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li><a href="../../../org/raxa/audioplayer/CallSuccess.html" title="class in org.raxa.audioplayer"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?org/raxa/audioplayer/CallHandler.html" target="_top">Frames</a></li>
<li><a href="CallHandler.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
